<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>My Thoughts</title>

  <!-- Supabase -->
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>

  <!-- Emoji Picker -->
  <script type="module" src="https://cdn.jsdelivr.net/npm/emoji-picker-element@^1/index.js"></script>

  <!-- Styles -->
  <link rel="stylesheet" href="style.css" />

  <!-- ‚úÖ INITIALIZE SUPABASE CLIENT BEFORE OTHER SCRIPTS -->
  <script>
    // Initialize Supabase client globally
    const supabaseUrl = 'YOUR_SUPABASE_PROJECT_URL'; // ‚Üê REPLACE WITH YOUR URL
    const supabaseKey = 'YOUR_SUPABASE_ANON_KEY';     // ‚Üê REPLACE WITH YOUR KEY

    window.supabaseClient = supabase.createClient(supabaseUrl, supabaseKey);

    // Optional: Log for debugging
    console.log('Supabase client initialized:', window.supabaseClient);
  </script>
</head>
<body>
  <div class="thought-box">
    <textarea id="memory-body" placeholder="what's on your mind?"></textarea>
    <div class="thought-actions">
      <button id="mediaButton">‚ûï</button>
      <button id="emojiButton">üôÇ</button>
      <button id="postButton">Post</button>
    </div>
    <div id="emojiPicker"></div>
    
    <!-- Add this missing upload progress container -->
    <div id="uploadProgress" style="display:none; margin-top: 10px;">
      <div class="progress-bar" style="height: 4px; background: #e2e8f0; border-radius: 2px; overflow: hidden;">
        <div id="progressFill" style="height: 100%; background: #5a67d8; width: 0%; transition: width 0.3s ease;"></div>
      </div>
      <span id="progressText" style="display: block; margin-top: 5px; font-size: 14px; color: #4a5568;">Uploading...</span>
    </div>

    <!-- Media Preview Container -->
    <div id="mediaPreviewContainer" style="display: none; margin-top: 10px; padding: 10px; border: 1px solid #e2e8f0; border-radius: 8px; background: #f7fafc;"></div>
  </div>

  <div class="posts-section">
    <h2>My Posts</h2>
    <div id="postsContainer"></div>
  </div>

  <!-- Hidden file input -->
  <input type="file" id="mediaInput" accept="image/*,video/*" style="display:none;" />

  <!-- Load media.js first (it initializes handlers that depend on supabase) -->
  <script type="module" src="media.js"></script>
  <!-- Then load main script -->
  <script type="module" src="script.js"></script>
</body>
</html>
